<%- include('../partials/header.ejs') %>

	<h1>Recipe show page</h1>
	<div id="recipe-container">
		<textarea disabled>
			<%= recipe.ingredients %>
		</textarea>
		<textarea disabled>
			<%= recipe.instructions %>
		</textarea>	

	<% if(loggedIn && userId == recipe.creator) { %>
		<a href="/recipes/<%= recipe._id %>/edit">Edit recipe</a> |
		<form method="POST" action="/recipes/<%= recipe._id %>?_method=DELETE">
			<button>Delete</button>
  		</form>
	<% } %>
	</div>

	<hr>

	  <h4>Discuss</h4>
	  <form method="POST" action="/comments/<%= recipe._id %>">
	  	<label for="rating">Rate this recipe:</label>

		<select name="rating" id="rating">
		    <option value="0">0</option>
		    <option value="1">1</option>
		    <option value="2">2</option>
		    <option value="3">3</option>
		    <option value="4">4</option>
		    <option value="5">5</option>
		</select>
	    <fieldset>
			<label for="commentText">Comment:</label>
	      	<textarea name="commentText" placeholder="enter comment here"></textarea>    
	    </fieldset>
	    <button>Add Comment</button>
	  </form>

	  <ul style="margin-top: 20px">
	    <% for (let i = 0; i < recipe.comments.length; i++) { -%>
	      <li>
	        <p>
	          <small>
	            <%= recipe.comments[i].author.username %> 
	            @ 
	            <%= recipe.comments[i].date.toLocaleString() %> 
	            Rating: <%=recipe.comments[i].rating%>
	          </small>
	          <br>
	          <%= recipe.comments[i].text %>        
	        </p>
			<% if (loggedIn && recipe.comments[i].author.id === userId) { -%>
	          <form method="POST" action="/comments/<%= recipe.id %>/<%= recipe.comments[i].id %>?_method=DELETE">
	            <button>Delete</button>
	          </form>
	        <% } -%>
	      </li>
	    <% } -%>
	  </ul>
	<hr>



<%- include('../partials/footer.ejs') %>
